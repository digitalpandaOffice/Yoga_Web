# Security Audit Report: Edvayu Educational Foundations Website

**Date:** 2025-12-11
**Target:** Frontend Website, Backend API, and CMS
**Auditor:** Antigravity AI

## 1. Executive Summary
A security review of the codebase was conducted, focusing on the PHP Backend (`Yoga_Backend`), React CMS (`CMS_MaterLogin`), and Frontend Website (`Frontend_Website`). 
**Overall Security Posture:** ‚ùå **Critical Vulnerabilities Detected**. The application is **not ready for production** deployment in its current state due to missing authentication mechanisms and potential data leaks.

## 2. Critical Vulnerabilities (Immediate Action Required)

### üö® 2.1. Broken Authentication (Dummy Tokens)
*   **Location:** `Yoga_Backend/app/Controllers/Auth.php`
*   **Issue:** The login endpoint returns a hardcoded static token: `'dummy_token_for_now'`. There appears to be no mechanism to verify genuine JSON Web Tokens (JWT) or sessions on protected API endpoints.
*   **Impact:** Any user can potentially bypass authentication or access administrative functions if they know the endpoints.
*   **Recommendation:** Implement real JWT generation using a library like `firebase/php-jwt`. Verify this token in the constructor or middleware of every protected Controller.

### üö® 2.2. Password Reset Token Leak
*   **Location:** `Yoga_Backend/app/Controllers/Auth.php` -> `forgotPassword()`
*   **Issue:** The password reset token is returned directly in the API response (`dev_token`).
*   **Impact:** An attacker can trigger a password reset for any user and immediately see the token needed to change the password, effectively taking over any account.
*   **Recommendation:** **NEVER** return the token in the API response. Generate the token, save it to the database, and email it to the user.

## 3. High Severity Issues

### üü† 3.1. Stored Cross-Site Scripting (XSS)
*   **Location:** Frontend Website (`index.html`, `contact.html`) & Backend DB
*   **Issue:** The frontend uses `.innerHTML` to render content fetched from the API (e.g., `updateValues`, `updateAbout`). The backend saves form data (e.g., inside `Franchise.php`) without sanitization.
*   **Impact:** If an attacker can inject malicious JavaScript into the `about` content or `settings` (via the CMS or Franchise form), that script will execute in the browser of every visitor to the website.
*   **Recommendation:** 
    *   Use `.textContent` instead of `.innerHTML` wherever possible.
    *   If HTML is required (e.g., for bold text), use a sanitization library like `DOMPurify` on the frontend before rendering.

### üü† 3.2. Insecure CORS Configuration
*   **Location:** `Yoga_Backend/public/index.php`
*   **Issue:** `Access-Control-Allow-Origin: *` is used.
*   **Impact:** Allows any malicious website to send authenticated requests to your backend on behalf of a user (if auth were implemented).
*   **Recommendation:** Change `*` to the specific domain of your frontend and CMS (e.g., `https://edvayueducationalfoundation.in`).

## 4. Moderate Severity Issues

### üü° 4.1. Sensitive Error Exposure
*   **Location:** `Yoga_Backend/app/Config/Database.php`
*   **Issue:** `echo "Connection Error: " . $e->getMessage();`
*   **Impact:** Database connection errors are printed directly to the screen/response. This can leak internal file paths, usernames, and database structure to attackers.
*   **Recommendation:** Log errors to a file instead of echoing them. Return a generic "Internal Server Error" message to the user.

### üü° 4.2. File Upload Security
*   **Location:** `Yoga_Backend/app/Controllers/Media.php`
*   **Issue:** While there is an allowlist extension check, relyence on `$_FILES['file']['type']` is insecure as it can be spoofed.
*   **Recommendation:**
    *   Configure the web server (Apache/Nginx) to **disable PHP execution** in the `public/uploads` directory.
    *   Use `finfo_file` (PHP FileInfo) to verify the MIME type from the file content, not the user-provided header.

## 5. Security Checklist for Production

| Category | Action Item | Status |
| :--- | :--- | :--- |
| **Database** | **SQL Injection:** Prepared statements are used correctly. | ‚úÖ PASS |
| **Database** | **Credentials:** Change default `root`/empty password. | ‚ùå FAIL |
| **Auth** | **JWT:** Implement real token generation & validation. | ‚ùå FAIL |
| **Auth** | **Passwords:** Ensure passwords are hashed (e.g., `password_hash`). | ‚ö†Ô∏è CHECK |
| **Network** | **HTTPS:** Enforce HTTPS on the live server. | ‚ö†Ô∏è TODO |
| **Network** | **CORS:** Restrict allowed origins. | ‚ùå FAIL |
| **Code** | **Debug Mode:** Disable error echoing. | ‚ùå FAIL |
| **Code** | **XSS:** Sanitize `innerHTML` inputs. | ‚ùå FAIL |

---
**Report Generated by Antigravity AI**
